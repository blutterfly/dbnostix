
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="google_sheets.html">
      
      
        <link rel="next" href="../algotrade/algotrade.html">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.8">
    
    
      
        <title>Advanced Techniques - DBNOSTIX</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootswatch@5.3.3/dist/cerulean/bootstrap.min.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
    <!-- Bootstrap 5 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">

  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#advanced-techniques" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="DBNOSTIX" class="md-header__button md-logo" aria-label="DBNOSTIX" data-md-component="logo">
      
  <img src="../images/blue_butterfly.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DBNOSTIX
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Advanced Techniques
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../index.html" class="md-tabs__link">
          
  
  Dbnostix

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../services/database_infrastructure.html" class="md-tabs__link">
          
  
  Services

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../python/00_landing.html" class="md-tabs__link">
          
  
  Python

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="contents.html" class="md-tabs__link">
          
  
  Pandas

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../algotrade/algotrade.html" class="md-tabs__link">
          
  
  AlgoTrade

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../options/contents.html" class="md-tabs__link">
          
  
  Options

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../database/database.html" class="md-tabs__link">
          
  
  Database

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../mkdocs/mkdocs.html" class="md-tabs__link">
          
  
  MkDocs

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="DBNOSTIX" class="md-nav__button md-logo" aria-label="DBNOSTIX" data-md-component="logo">
      
  <img src="../images/blue_butterfly.png" alt="logo">

    </a>
    DBNOSTIX
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dbnostix
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Dbnostix
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dbnostix/contents.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contents
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dbnostix/about.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dbnostix/contact.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contact
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dbnostix/services.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Services
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Services
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../services/database_infrastructure.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database Infrastructure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../services/data_science.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Science
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../services/predictive_modeling.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Predictive Modeling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../services/large_language_model.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Large Language Model
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Python
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/00_landing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/00_Contents.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contents
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/00_Contents_Jazzy.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python for Data Science &amp; Predictive Modeling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/01_Overview.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    01 üìò Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/02_Setup_Installation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    02 üõ†Ô∏è Setup and Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/03_Core_Concepts.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    03 ‚öôÔ∏è Core Concepts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/04_Advanced_Concepts.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    04 ‚ö° Advanced Concepts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/05_Syntax_and_Variables.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    05 üìù Syntax and Variables
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/06_Control_Flow.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    06 üîÑ Control Flow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/07_Data_Structures.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    07 üéí Data Structures
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/08_Functions_and_Modules.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    08 üé≠ Functions and Modules
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/09_Object-Oriented_Programming.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    09 üèóÔ∏è Object-Oriented
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/10_Python_Standard_Library.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    10 üß∞ Python Standard Library
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/11_File_Handling_and_IO.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11 üåê File Handling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/12_Exception_Handling_and_Debugging.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    12 ‚ö° Errors and Debugging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/13_Web_Development.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    13 üì° Web Development
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/14_Data_Science.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    14 üìä Data Science
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/15_Machine_Learning_and_AI.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    15 üß† Machine Learning and AI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/16_Predictive_Modeling.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    16 üîÆ Predictive Modeling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/17_Databases.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    17 üèõÔ∏è Databases
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/17x_Examples.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Real-World Examples
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/pandas.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pandas
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/yfinance.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Yfinance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/best_practice.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Best Practice
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Pandas
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Pandas
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="contents.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contents
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="select_filter.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Select and Filter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="generate_data.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generate Data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="cheat_sheet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cheatsheet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="list_function.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    List Function
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="quick_examples.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick Examples
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="numpy.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NumPy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="skimpy.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Skimpy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="summarizer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SummaryTools
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="profiling.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Profiling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="google_sheets.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Google Sheets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Advanced Techniques
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="advanced_techniques.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Advanced Techniques
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-data-chunking" class="md-nav__link">
    <span class="md-ellipsis">
      1. Data chunking
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-progress-bar" class="md-nav__link">
    <span class="md-ellipsis">
      2. Progress bar
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-populate-multiple-columns" class="md-nav__link">
    <span class="md-ellipsis">
      3. Populate Multiple Columns
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-parallel-processing" class="md-nav__link">
    <span class="md-ellipsis">
      4. Parallel Processing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-complex-merging" class="md-nav__link">
    <span class="md-ellipsis">
      5. Complex Merging
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-data-segmentation" class="md-nav__link">
    <span class="md-ellipsis">
      6. Data Segmentation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-cross-tabulation-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      7. Cross-Tabulation Analysis
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    AlgoTrade
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            AlgoTrade
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algotrade/algotrade.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Algotrade
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algotrade/extract.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extract
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algotrade/transform.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transform
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algotrade/load.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Load
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Options
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Options
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../options/contents.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Options
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../options/strangle_strategy.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Strangle Strategy
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Database
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Database
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../database/database.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../database/db2.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Db2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../database/postgresql.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Postgresql
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../database/duckdb.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Duckdb
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    MkDocs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            MkDocs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mkdocs/mkdocs.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mkdocs/admonitions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Admonitions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mkdocs/collapsible_sections.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Collapsible Sections
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mkdocs/emoji_guide.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Emoji Guide
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-data-chunking" class="md-nav__link">
    <span class="md-ellipsis">
      1. Data chunking
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-progress-bar" class="md-nav__link">
    <span class="md-ellipsis">
      2. Progress bar
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-populate-multiple-columns" class="md-nav__link">
    <span class="md-ellipsis">
      3. Populate Multiple Columns
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-parallel-processing" class="md-nav__link">
    <span class="md-ellipsis">
      4. Parallel Processing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-complex-merging" class="md-nav__link">
    <span class="md-ellipsis">
      5. Complex Merging
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-data-segmentation" class="md-nav__link">
    <span class="md-ellipsis">
      6. Data Segmentation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-cross-tabulation-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      7. Cross-Tabulation Analysis
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="advanced-techniques">Advanced Techniques</h1>
<p>Advanced Pandas Techniques for Data Processing and Performance</p>
<h3 id="1-data-chunking">1. Data chunking</h3>
<p>There are often scenarios we encounter where the size of the data is more
than the available memory (RAM) we have. In such cases, it‚Äôs a good idea to
read data in chunks from the file so that the system doesn‚Äôt run out of
memory.</p>
<div class="highlight"><pre><span></span><code><span class="mi">1</span> <span class="c1"># Initialize an empty list to store the chunks</span>
<span class="mi">2</span> <span class="n">private_rooms</span> <span class="o">=</span> <span class="p">[]</span>
<span class="mi">3</span>
<span class="mi">4</span> <span class="c1"># Read the CSV file in chunks</span>
<span class="mi">5</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/listings.csv&#39;</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
<span class="mi">6</span>     <span class="c1"># Process each chunk (for example, filter listings where room_type is &quot;Private room&quot;)</span>
<span class="mi">7</span>     <span class="n">processed_chunk</span> <span class="o">=</span> <span class="n">chunk</span><span class="p">[</span><span class="n">chunk</span><span class="p">[</span><span class="s2">&quot;room_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Private room&quot;</span><span class="p">]</span>
<span class="mi">8</span>     
<span class="mi">9</span>     <span class="c1"># Append the processed chunk to the list</span>
<span class="mi">10</span>     <span class="n">private_rooms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">processed_chunk</span><span class="p">)</span>
<span class="mi">11</span>
<span class="mi">12</span> <span class="c1"># Combine all processed chunks into a dataframe</span>
<span class="mi">13</span> <span class="n">private_rooms</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">private_rooms</span><span class="p">)</span>
</code></pre></div>
<h3 id="2-progress-bar">2. Progress bar</h3>
<p>Pandas‚Äô apply() functions, which are commonly used to perform element-
wise operations on DataFrame columns or rows.</p>
<div class="highlight"><pre><span></span><code><span class="mi">1</span> <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="mi">2</span> <span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="mi">3</span>
<span class="mi">4</span> <span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>
<span class="mi">5</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">pandas</span><span class="p">()</span>  <span class="c1"># add this to integrate progress bar functionality to pandas</span>
<span class="mi">6</span>
<span class="mi">7</span>
<span class="mi">8</span> <span class="k">def</span><span class="w"> </span><span class="nf">convert_to_datetime</span><span class="p">(</span><span class="n">date</span><span class="p">):</span>
<span class="mi">9</span>     <span class="c1"># return date if type of date is not string</span>
<span class="mi">10</span>     <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">:</span>
<span class="mi">11</span>         <span class="k">return</span> <span class="n">date</span>
<span class="mi">12</span>     
<span class="mi">13</span>     <span class="c1"># time.sleep() added to demonstrate the progress bar more effectively </span>
<span class="mi">14</span>     <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="mi">15</span>
<span class="mi">16</span>     <span class="c1"># returns a datetime object</span>
<span class="mi">17</span>     <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="mi">18</span>
<span class="mi">19</span> <span class="n">private_rooms</span><span class="p">[</span><span class="s2">&quot;last_review&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">private_rooms</span><span class="p">[</span><span class="s2">&quot;last_review&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">progress_apply</span><span class="p">(</span><span class="n">convert_to_datetime</span><span class="p">)</span>
</code></pre></div>
<h3 id="3-populate-multiple-columns">3. Populate Multiple Columns</h3>
<p>Solution: apply() with result_type="expand"</p>
<div class="highlight"><pre><span></span><code><span class="mi">1</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_date_and_month_name</span><span class="p">(</span><span class="n">last_review_date</span><span class="p">):</span>
<span class="mi">2</span>     <span class="c1"># returns the day and month</span>
<span class="mi">3</span>     <span class="k">return</span> <span class="n">last_review_date</span><span class="o">.</span><span class="n">day_name</span><span class="p">(),</span> <span class="n">last_review_date</span><span class="o">.</span><span class="n">month_name</span><span class="p">()</span>
<span class="mi">4</span>
<span class="mi">5</span>
<span class="mi">6</span> <span class="n">private_rooms</span><span class="p">[[</span><span class="s2">&quot;Day&quot;</span><span class="p">,</span> <span class="s2">&quot;Month&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">private_rooms</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
<span class="mi">7</span>     <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">get_date_and_month_name</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;last_review&quot;</span><span class="p">]),</span>
<span class="mi">8</span>     <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="mi">9</span>     <span class="n">result_type</span><span class="o">=</span><span class="s2">&quot;expand&quot;</span>
<span class="mi">10</span> <span class="p">)</span>
</code></pre></div>
<h3 id="4-parallel-processing">4. Parallel Processing</h3>
<p>Use multiprocessing module.  (using np.array_split()) into multiple chunks (depending on the number of
cores available in your system)
Once the chunks are processed and the desired output for each chunk is
obtained, it can be concatenated back to a single DataFrame.</p>
<div class="highlight"><pre><span></span><code><span class="mi">1</span> <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="mi">2</span> <span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="mi">3</span> <span class="kn">from</span><span class="w"> </span><span class="nn">multiprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pool</span>
<span class="mi">4</span>
<span class="mi">5</span> <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="mi">6</span> <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="mi">7</span> <span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>
<span class="mi">8</span>
<span class="mi">9</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">pandas</span><span class="p">()</span>
<span class="mi">10</span>
<span class="mi">11</span>
<span class="mi">12</span> <span class="k">def</span><span class="w"> </span><span class="nf">predict_sentiment</span><span class="p">(</span><span class="n">review</span><span class="p">):</span>
<span class="mi">13</span>     <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>  <span class="c1"># simulating time taken by prediction model</span>
<span class="mi">14</span>     <span class="k">return</span> <span class="s2">&quot;Positive&quot;</span> <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span> <span class="k">else</span> <span class="s2">&quot;Negative&quot;</span>
<span class="mi">15</span>
<span class="mi">16</span>
<span class="mi">17</span> <span class="k">def</span><span class="w"> </span><span class="nf">batch_predict_sentiment</span><span class="p">(</span><span class="n">review_df</span><span class="p">):</span>
<span class="mi">18</span>     <span class="n">review_df</span><span class="p">[</span><span class="s2">&quot;sentiment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">review_df</span><span class="p">[</span><span class="s2">&quot;comments&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">progress_apply</span><span class="p">(</span><span class="n">predict_sentiment</span><span class="p">)</span>
<span class="mi">19</span>     <span class="k">return</span> <span class="n">review_df</span>
<span class="mi">20</span>
<span class="mi">21</span>
<span class="mi">22</span> <span class="k">def</span><span class="w"> </span><span class="nf">fetch_sentiment_for_review</span><span class="p">():</span>
<span class="mi">23</span>     <span class="n">n_cores</span> <span class="o">=</span> <span class="mi">64</span>
<span class="mi">24</span>     <span class="n">reviews</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/reviews.csv&quot;</span><span class="p">)</span>
<span class="mi">25</span>     <span class="n">review_batches</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_split</span><span class="p">(</span><span class="n">reviews</span><span class="p">,</span> <span class="n">n_cores</span><span class="p">)</span>  <span class="c1"># split into same number of batches as n_c</span>
<span class="mi">26</span>     
<span class="mi">27</span>     <span class="c1"># Processing Parallely</span>
<span class="mi">28</span>     <span class="k">with</span> <span class="n">Pool</span><span class="p">(</span><span class="n">n_cores</span><span class="p">)</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>
<span class="mi">29</span>         <span class="n">sentiment_prediction_batches</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">batch_predict_sentiment</span><span class="p">,</span> <span class="n">review_batches</span><span class="p">)</span>
<span class="mi">30</span>
<span class="mi">31</span>     <span class="c1"># Once all the batches are processed, concatenate list of DataFrames into a single DataFrame</span>
<span class="mi">32</span>     <span class="n">sentiment_prediction</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">sentiment_prediction_batches</span><span class="p">)</span>
<span class="mi">33</span>     <span class="k">return</span> <span class="n">sentiment_prediction</span>
<span class="mi">34</span>
<span class="mi">35</span>
<span class="mi">36</span> <span class="n">reviews_with_sentiment</span> <span class="o">=</span> <span class="n">fetch_sentiment_for_review</span><span class="p">()</span>
</code></pre></div>
<p>From more than 13 hours to less than 13 minutes!
Each batch consists of 7521 reviews and there are a total of 64 batches. In
this scenario</p>
<p>Tip: set n_cores more than the actual number of cores my system has. 
This is because during the execution of time.sleep(0.1) the
CPU remains idle and each process interleaves for other process to execute.
If your process is CPU intensive, it is recommended to keep n_cores less
than the actual number of cores your system has.</p>
<h3 id="5-complex-merging">5. Complex Merging</h3>
<p>Merging is quite a common operation performed by individuals who deal
with data. However, sometimes it can get quite complicated to understand if
any particular data points were lost during the merging process. It might be
due to a plethora of reasons ‚Äî the worst one being, malformed or faulty
data.</p>
<p>The indicator=True.  When enabled it creates a new column named _merge which can
denote three different scenarios based on the type of merge operation
performed.</p>
<ul>
<li>left_only ‚Äî indicates that the row‚Äôs key only exists in the left DataFrame
and it couldn‚Äôt find a match in the right DataFrame</li>
<li>right_only ‚Äî indicates that the row‚Äôs key only exists in the right</li>
<li>both ‚Äî indicates that the row‚Äôs key exists in both the DataFrames and data</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">merged_df</span> <span class="o">=</span> <span class="n">listings</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">reviews</span><span class="p">,</span>
    <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span>
    <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;listing_id&quot;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span>
    <span class="n">indicator</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">merged_df</span><span class="o">.</span><span class="n">shape</span>
</code></pre></div>
<h2 id="6-data-segmentation">6. Data Segmentation</h2>
<p>pd.cut() is a powerful function that can be used when you need to segment
data into multiple bins. It can also act as a way to convert continuous values
into categorical values.
One such scenario is demonstrated in the example below. We will be
Segmenting the price of each listing into multiple price brackets (bins).
We can set a predetermined number of price brackets ‚Äî ‚Äú$0 ‚Äî $100‚Äù, ‚Äú$101 ‚Äî
$250‚Äù, ‚Äú$251 ‚Äî $500‚Äù, ‚Äú$500 ‚Äî $1000‚Äù, and ‚Äú$1000+‚Äù.</p>
<p>Create bins and label for each bin
<div class="highlight"><pre><span></span><code><span class="n">bins</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;$0 - $100&quot;</span><span class="p">,</span> <span class="s2">&quot;$101 - $250&quot;</span><span class="p">,</span> <span class="s2">&quot;$251 - $500&quot;</span><span class="p">,</span> <span class="s2">&quot;$500 - $1000&quot;</span><span class="p">,</span> <span class="s2">&quot;$1000+&quot;</span><span class="p">]</span>
<span class="n">listings</span><span class="p">[</span><span class="s2">&quot;price_bucket&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">listings</span><span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
</code></pre></div></p>
<p>Please note here that the number of labels (5) is less than number of bins (6)
by one. This is because the initial two values in the bin belong to the first
label.</p>
<h2 id="7-cross-tabulation-analysis">7. Cross-Tabulation Analysis</h2>
<p>Using the above data, we can go one step further and perform a cross-
tabulation between the price brackets and room types available for those
price brackets.
Here‚Äôs where pd.crosstab() comes into play. It can be used to perform a
simple cross-tabulation between price_bucket and room_type.</p>
<div class="highlight"><pre><span></span><code><span class="n">room_type_breakup</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span>
    <span class="n">listings</span><span class="p">[</span><span class="s2">&quot;price_bucket&quot;</span><span class="p">],</span>
    <span class="n">listings</span><span class="p">[</span><span class="s2">&quot;room_type&quot;</span><span class="p">],</span>
    <span class="n">margins</span><span class="o">=</span><span class="kc">True</span>  <span class="c1"># This will add the row and column totals</span>
<span class="p">)</span>
</code></pre></div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy", "content.code.annotate", "content.tabs.link", "navigation.expand", "navigation.instant", "navigation.sections", "navigation.tabs", "toc.follow", "content.tooltips", "content.code.highlight", "content.grid"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>